<!DOCTYPE html>
<html lang="id" x-data="ttsApp()" x-init="init()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panggilan Monse System</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-volume-up"></i>
                <div>
                    <h1>Panggilan Monse System</h1>
                    <p class="subtitle">Output audio terpusat dari satu komputer</p>
                </div>
            </div>
            <div class="header-controls">
                <div class="server-status" :class="serverStatus">
                    <i class="fas" :class="{
                        'fa-wifi': serverStatus === 'connected',
                        'fa-wifi-slash': serverStatus === 'disconnected',
                        'fa-exclamation-triangle': serverStatus === 'error'
                    }"></i>
                    <span x-text="serverStatusText"></span>
                </div>
                <div class="client-id" x-show="clientId">
                    <i class="fas fa-id-card"></i>
                    <span>ID: <span x-text="clientIdShort"></span></span>
                </div>
                <div class="master-preference-badge" 
                     :class="masterStatusColor" 
                     @click="toggleMasterPreference()"
                     style="cursor: pointer;">
                    <i class="fas" :class="{
                        'fa-crown': isMaster,
                        'fa-hourglass-half': wantsToBeMaster && !isMaster,
                        'fa-desktop': !wantsToBeMaster && !isMaster
                    }"></i>
                    <span x-text="masterStatusBadge"></span>
                </div>
            </div>
        </header>

        <!-- Master Control Panel -->
        <section class="master-control-panel" x-show="clientId">
            <div class="panel-header">
                <h3><i class="fas fa-crown"></i> Kontrol Master</h3>
                <div class="client-count">
                    <i class="fas fa-users"></i>
                    <span x-text="connectedClients.length"></span> komputer terhubung
                </div>
            </div>
            
            <div class="panel-body">
                <div x-show="!isMaster" class="master-request">
                    <div class="master-info">
                        <i class="fas fa-info-circle"></i>
                        <p>Status: <strong :class="masterStatusColor" x-text="masterStatusBadge"></strong> - 
                           <span x-show="wantsToBeMaster">Anda akan otomatis menjadi Master saat tersedia</span>
                           <span x-show="!wantsToBeMaster">Audio akan diputar di komputer Master</span>
                        </p>
                    </div>
                    <div class="master-request-actions">
                        <button @click="requestMasterRole()" 
                                :disabled="isRequestingMaster || isMaster" 
                                class="btn btn-success btn-master">
                            <i class="fas fa-crown"></i>
                            <span x-text="isRequestingMaster ? 'Meminta...' : 'Jadikan Master'"></span>
                        </button>
                        <button @click="toggleMasterPreference()" class="btn btn-outline">
                            <i class="fas fa-cog"></i> Pengaturan
                        </button>
                    </div>
                    <p class="hint">* Master akan menerima dan memutar audio dari semua komputer</p>
                    <p class="hint" x-show="wantsToBeMaster">
                        <i class="fas fa-sync-alt"></i> Auto-reconnect aktif: Anda akan otomatis menjadi Master saat tersedia
                    </p>
                </div>
                
                <div x-show="isMaster" class="master-active">
                    <div class="master-badge">
                        <i class="fas fa-crown"></i>
                        <div>
                            <h4>Anda adalah Master Controller</h4>
                            <p>Audio akan diputar di komputer ini. Semua komputer lain mengirim teks ke Anda.</p>
                            <p class="auto-reconnect-info" x-show="wantsToBeMaster">
                                <i class="fas fa-sync-alt"></i> Auto-reconnect aktif: Anda akan otomatis kembali sebagai Master jika terputus
                            </p>
                        </div>
                    </div>
                    <div class="master-controls">
                        <button @click="playAudio()" 
                                :disabled="!currentAudio || isPlaying" 
                                class="btn btn-primary">
                            <i class="fas fa-play"></i> Putar Audio
                        </button>
                        <button @click="pauseAudio()" 
                                :disabled="!isPlaying" 
                                class="btn btn-warning">
                            <i class="fas fa-pause"></i> Jeda
                        </button>
                        <button @click="stopAudio()" 
                                :disabled="!currentAudio" 
                                class="btn btn-secondary">
                            <i class="fas fa-stop"></i> Stop
                        </button>
                        <div class="master-release-options">
                            <button @click="releaseMasterRole(false)" 
                                    class="btn btn-outline">
                                <i class="fas fa-sign-out-alt"></i> Lepaskan Saja
                            </button>
                            <button @click="releaseMasterRole(true)" 
                                    class="btn btn-outline btn-danger">
                                <i class="fas fa-times-circle"></i> Lepaskan & Hapus Preferensi
                            </button>
                        </div>
                    </div>
                    <div class="master-stats" x-show="currentAudio">
                        <div class="stat">
                            <i class="fas fa-clock"></i>
                            <span>Durasi: <strong x-text="currentAudio?.duration + ' detik'"></strong></span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-microphone"></i>
                            <span>Dari: <strong x-text="currentAudio?.fromClientId || 'Unknown'"></strong></span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-history"></i>
                            <span>Status: <strong x-text="isPlaying ? 'Sedang Diputar' : 'Siap'"></strong></span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Connected Clients -->
        <section x-show="connectedClients.length > 1" class="card clients-section">
            <div class="card-header">
                <h3><i class="fas fa-network-wired"></i> Komputer Terhubung</h3>
                <span class="badge" x-text="connectedClients.length"></span>
            </div>
            <div class="card-body">
                <div class="clients-grid">
                    <template x-for="client in connectedClients" :key="client.id">
                        <div class="client-card" :class="{ 'master': client.isMaster, 'wants-master': connectedClients.find(c => c.id === client.id)?.wantsToBeMaster }">
                            <div class="client-avatar" :class="{ 'master': client.isMaster, 'wants-master': connectedClients.find(c => c.id === client.id)?.wantsToBeMaster }">
                                <i class="fas" :class="client.isMaster ? 'fa-crown' : (connectedClients.find(c => c.id === client.id)?.wantsToBeMaster ? 'fa-hourglass-half' : 'fa-desktop')"></i>
                            </div>
                            <div class="client-info">
                                <h4 x-text="client.id.substring(0, 12)"></h4>
                                <div class="client-roles">
                                    <span :class="{ 'master': client.isMaster }" 
                                          x-text="client.isMaster ? 'Master Controller' : 'Client'"></span>
                                    <span x-show="connectedClients.find(c => c.id === client.id)?.wantsToBeMaster && !client.isMaster" 
                                          class="wants-master-badge">
                                        <i class="fas fa-clock"></i> Ingin Master
                                    </span>
                                </div>
                                <small x-text="formatTime(client.joinedAt)"></small>
                            </div>
                            <div class="client-status" :class="{ 
                                'online': true, 
                                'master': client.isMaster,
                                'wants-master': connectedClients.find(c => c.id === client.id)?.wantsToBeMaster && !client.isMaster
                            }">
                                <i class="fas fa-circle"></i>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </section>

        <main class="main-content">
            <!-- Input Section -->
            <section class="card input-section">
                <div class="card-header">
                    <h2><i class="fas fa-keyboard"></i> Input Teks</h2>
                    <div class="char-count">
                        <span x-text="charCount"></span>/<span x-text="maxChars"></span> karakter
                        <span x-show="wordCount > 0">â€¢ <span x-text="wordCount"></span> kata</span>
                    </div>
                </div>
                <div class="card-body">
                    <textarea x-model="text"
                              @input="updateCharCount()"
                              placeholder="Ketik atau tempel teks yang ingin diubah menjadi suara... (Audio akan diputar di komputer Master)"
                              rows="4"
                              :maxlength="maxChars"
                              :class="{'has-error': charCount >= maxChars}"
                              class="text-input"></textarea>

                    <div class="text-actions">
                        <button @click="clearText()" class="btn btn-outline">
                            <i class="fas fa-trash-alt"></i> Hapus
                        </button>
                        <button @click="pasteText()" class="btn btn-outline">
                            <i class="fas fa-paste"></i> Tempel
                        </button>
                        <button @click="loadExample()" class="btn btn-outline">
                            <i class="fas fa-lightbulb"></i> Contoh
                        </button>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section class="card settings-section">
                <div class="card-header">
                    <h2><i class="fas fa-sliders-h"></i> Pengaturan</h2>
                </div>
                <div class="card-body">
                    <div class="settings-grid">
                        <div class="setting">
                            <label for="language">
                                <i class="fas fa-language"></i> Bahasa
                            </label>
                            <select id="language" x-model="language" class="select-input">
                                <option value="" disabled>Pilih bahasa...</option>
                                <template x-for="lang in languages" :key="lang.code">
                                    <option :value="lang.code" x-text="`${lang.name} (${lang.nativeName})`"></option>
                                </template>
                            </select>
                        </div>

                        <div class="setting">
                            <label for="speed">
                                <i class="fas fa-tachometer-alt"></i> Kecepatan
                                <span class="speed-value" x-text="`${speed}x`"></span>
                            </label>
                            <div class="slider-container">
                                <input type="range" id="speed" x-model="speed" 
                                       min="0.5" max="2" step="0.1" class="slider">
                                <div class="slider-labels">
                                    <span>Lambat (0.5x)</span>
                                    <span>Normal (1.0x)</span>
                                    <span>Cepat (2.0x)</span>
                                </div>
                            </div>
                        </div>

                        <div class="setting">
                            <label for="priority">
                                <i class="fas fa-flag"></i> Prioritas
                            </label>
                            <select id="priority" x-model="priority" class="select-input">
                                <option value="low">Rendah</option>
                                <option value="normal">Normal</option>
                                <option value="high">Tinggi</option>
                                <option value="urgent">Sangat Penting</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Action Section -->
            <section class="action-section">
                <button @click="convertToSpeech()" 
                        :disabled="isLoading || !text || isMaster && !isMasterReady"
                        class="btn btn-primary btn-convert">
                    <i class="fas" :class="isLoading ? 'fa-spinner fa-spin' : 'fa-paper-plane'"></i>
                    <span x-text="getConvertButtonText()"></span>
                </button>
                
                <button @click="convertAndBroadcast()" 
                        :disabled="isLoading || !text || !isMaster"
                        x-show="isMaster"
                        class="btn btn-success">
                    <i class="fas fa-broadcast-tower"></i>
                    <span>Kirim ke Semua</span>
                </button>
            </section>

            <!-- Audio Player Section (Master Only) -->
            <section x-show="isMaster && currentAudio" class="card audio-section">
                <div class="card-header">
                    <h3><i class="fas fa-music"></i> Pemutar Audio (Master)</h3>
                    <div class="audio-source" x-show="currentAudio?.fromClientId">
                        <i class="fas fa-user"></i>
                        <span>Dari: <strong x-text="currentAudio?.fromClientId"></strong></span>
                    </div>
                </div>
                <div class="card-body">
                    <div class="audio-player">
                        <audio id="masterAudioPlayer" 
                               :src="currentAudio?.audioUrl" 
                               controls
                               @play="onAudioPlay()"
                               @pause="onAudioPause()"
                               @ended="onAudioEnd()"
                               class="audio-element"></audio>
                        
                        <div class="audio-info">
                            <div class="info-item">
                                <i class="fas fa-clock"></i>
                                <span>Durasi: <strong x-text="currentAudio?.duration + ' detik'"></strong></span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-language"></i>
                                <span>Bahasa: <strong x-text="getLanguageName(currentAudio?.language)"></strong></span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-text-height"></i>
                                <span>Karakter: <strong x-text="currentAudio?.textLength"></strong></span>
                            </div>
                        </div>
                        
                        <div class="audio-actions">
                            <button @click="downloadAudio()" class="btn btn-outline">
                                <i class="fas fa-download"></i> Unduh
                            </button>
                            <button @click="shareAudio()" class="btn btn-outline">
                                <i class="fas fa-share-alt"></i> Bagikan
                            </button>
                            <button @click="clearAudio()" class="btn btn-outline">
                                <i class="fas fa-times"></i> Hapus
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Notification Section -->
            <section x-show="notifications.length > 0" class="notifications-section">
                <div class="notifications-container">
                    <template x-for="notification in notifications.slice().reverse().slice(0, 3)" :key="notification.id">
                        <div class="notification" :class="notification.type" @click="removeNotification(notification.id)">
                            <i class="fas" :class="getNotificationIcon(notification.type)"></i>
                            <div class="notification-content">
                                <p x-text="notification.message"></p>
                                <small x-text="formatTime(notification.timestamp)"></small>
                            </div>
                            <button @click="removeNotification(notification.id)" class="btn-close">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </template>
                </div>
            </section>

            <!-- History Section -->
            <section x-show="history.length > 0" class="card history-section">
                <div class="card-header">
                    <h3><i class="fas fa-history"></i> Riwayat Pengiriman</h3>
                    <button @click="clearHistory()" class="btn btn-small">
                        <i class="fas fa-trash"></i> Hapus Semua
                    </button>
                </div>
                <div class="card-body">
                    <div class="history-list">
                        <template x-for="(item, index) in history.slice().reverse()" :key="item.id">
                            <div class="history-item" :class="{ 'success': item.success, 'error': !item.success }">
                                <div class="history-content">
                                    <div class="history-text" x-text="truncateText(item.text, 80)"></div>
                                    <div class="history-meta">
                                        <span><i class="fas fa-language"></i> <span x-text="getLanguageCode(item.language)"></span></span>
                                        <span><i class="fas fa-clock"></i> <span x-text="formatTime(item.timestamp)"></span></span>
                                        <span><i class="fas" :class="item.success ? 'fa-check-circle' : 'fa-times-circle'"></i></span>
                                    </div>
                                </div>
                                <div class="history-actions">
                                    <button @click="loadHistoryItem(item)" class="btn btn-small">
                                        <i class="fas fa-redo"></i> Gunakan Lagi
                                    </button>
                                    <button @click="removeHistoryItem(item.id)" class="btn btn-small btn-outline">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </section>

            <!-- System Status -->
            <section class="card status-section">
                <div class="card-header">
                    <h3><i class="fas fa-chart-line"></i> Status Sistem</h3>
                </div>
                <div class="card-body">
                    <div class="status-grid">
                        <div class="status-item">
                            <i class="fas fa-server"></i>
                            <div>
                                <h4>Server</h4>
                                <p x-text="serverStatus === 'connected' ? 'Aktif' : 'Tidak Aktif'"></p>
                            </div>
                        </div>
                        <div class="status-item">
                            <i class="fas fa-users"></i>
                            <div>
                                <h4>Klien Terhubung</h4>
                                <p x-text="connectedClients.length"></p>
                            </div>
                        </div>
                        <div class="status-item">
                            <i class="fas fa-crown"></i>
                            <div>
                                <h4>Master</h4>
                                <p x-text="isMaster ? 'Anda' : masterClientId || 'Tidak Ada'"></p>
                            </div>
                        </div>
                        <div class="status-item">
                            <i class="fas fa-history"></i>
                            <div>
                                <h4>Riwayat</h4>
                                <p x-text="history.length + ' item'"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-info">
                    <p>TTS Multi-Client System v2.0 &copy; 2024</p>
                    <p class="footer-note">Sistem Text-to-Speech dengan output audio terpusat</p>
                    <p class="footer-feature">
                        <i class="fas fa-sync-alt"></i> Fitur Master Auto-Reconnect Aktif
                    </p>
                </div>
                <div class="footer-links">
                    <button @click="showSystemInfo()" class="btn-link">
                        <i class="fas fa-info-circle"></i> Info Sistem
                    </button>
                    <button @click="toggleMasterPreference()" class="btn-link">
                        <i class="fas fa-crown"></i> Pengaturan Master
                    </button>
                    <button @click="testConnection()" class="btn-link">
                        <i class="fas fa-wifi"></i> Test Koneksi
                    </button>
                    <button @click="showHelp()" class="btn-link">
                        <i class="fas fa-question-circle"></i> Bantuan
                    </button>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modals -->
    <!-- Master Preference Modal -->
    <div x-show="showMasterPreferenceModal" class="modal-overlay" @click.self="showMasterPreferenceModal = false">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-crown"></i> Pengaturan Master</h3>
                <button @click="showMasterPreferenceModal = false" class="btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="master-preference">
                    <div class="preference-section">
                        <h4><i class="fas fa-user-crown"></i> Preferensi Master</h4>
                        
                        <div class="preference-item">
                            <label class="checkbox-label">
                                <input type="checkbox" x-model="wantsToBeMaster" @change="saveMasterPreference()">
                                <div class="checkbox-content">
                                    <strong>Ingin selalu menjadi Master</strong>
                                    <p>Sistem akan otomatis meminta peran Master ketika Anda terhubung dan belum ada Master aktif.</p>
                                </div>
                            </label>
                        </div>
                        
                        <div class="preference-item">
                            <label class="checkbox-label">
                                <input type="checkbox" x-model="autoRequestMaster" @change="saveMasterPreference()">
                                <div class="checkbox-content">
                                    <strong>Otomatis request Master setelah reconnect</strong>
                                    <p>Akan mencoba mengambil peran Master jika terputus dan menyambung kembali.</p>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div class="preference-section">
                        <h4><i class="fas fa-info-circle"></i> Informasi Master</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <i class="fas fa-check-circle"></i>
                                <div>
                                    <strong>Satu Master Aktif</strong>
                                    <p>Hanya satu Master yang aktif dalam sistem</p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-clock"></i>
                                <div>
                                    <strong>Auto-Reconnect</strong>
                                    <p>Master akan otomatis kembali saat reconnect</p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-save"></i>
                                <div>
                                    <strong>Preferensi Tersimpan</strong>
                                    <p>Preferensi disimpan di browser ini</p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-sync-alt"></i>
                                <div>
                                    <strong>State Recovery</strong>
                                    <p>Status audio disimpan dan dipulihkan</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="preference-section current-status">
                        <h4><i class="fas fa-chart-bar"></i> Status Saat Ini</h4>
                        <div class="status-grid">
                            <div class="status-item">
                                <span>Status Master:</span>
                                <strong :class="masterStatusColor" x-text="masterStatusBadge"></strong>
                            </div>
                            <div class="status-item">
                                <span>Ingin Master:</span>
                                <strong x-text="wantsToBeMaster ? 'Ya' : 'Tidak'"></strong>
                            </div>
                            <div class="status-item">
                                <span>Auto-Reconnect:</span>
                                <strong x-text="autoRequestMaster ? 'Aktif' : 'Nonaktif'"></strong>
                            </div>
                            <div class="status-item">
                                <span>Client ID:</span>
                                <strong x-text="clientIdShort || 'Belum terhubung'"></strong>
                            </div>
                        </div>
                    </div>
                    
                    <div class="preference-actions">
                        <button @click="clearMasterPreference(); showMasterPreferenceModal = false" 
                                class="btn btn-outline btn-danger">
                            <i class="fas fa-trash"></i> Hapus Semua Preferensi
                        </button>
                        <button @click="showMasterPreferenceModal = false" class="btn btn-primary">
                            <i class="fas fa-check"></i> Simpan & Tutup
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Info Modal -->
    <div x-show="showSystemInfoModal" class="modal-overlay" @click.self="showSystemInfoModal = false">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> Informasi Sistem</h3>
                <button @click="showSystemInfoModal = false" class="btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="system-info">
                    <h4>TTS Multi-Client System v2.0</h4>
                    <p>Sistem ini memungkinkan beberapa komputer mengirim teks untuk dikonversi menjadi suara, tetapi output audio hanya dari satu komputer (Master Controller).</p>
                    
                    <div class="info-grid">
                        <div class="info-item">
                            <strong><i class="fas fa-user-crown"></i> Master Controller:</strong>
                            <p>Komputer yang memutar audio. Hanya satu master yang aktif.</p>
                        </div>
                        <div class="info-item">
                            <strong><i class="fas fa-desktop"></i> Client Biasa:</strong>
                            <p>Komputer yang hanya mengirim teks. Tidak memutar audio.</p>
                        </div>
                        <div class="info-item">
                            <strong><i class="fas fa-broadcast-tower"></i> Broadcast:</strong>
                            <p>Master dapat mengirim audio ke semua komputer.</p>
                        </div>
                        <div class="info-item">
                            <strong><i class="fas fa-history"></i> Antrian:</strong>
                            <p>Teks dikirim saat tidak ada master akan masuk antrian.</p>
                        </div>
                    </div>
                    
                    <h5><i class="fas fa-sync-alt"></i> Fitur Auto-Reconnect Master</h5>
                    <p>Sistem ini memiliki fitur auto-reconnect untuk Master Controller:</p>
                    <ul>
                        <li>Master preference disimpan di localStorage</li>
                        <li>Otomatis request role Master saat reconnect</li>
                        <li>State audio disimpan dan dipulihkan</li>
                        <li>Max 3x reconnect attempts</li>
                        <li>Preferensi bisa diatur melalui "Pengaturan Master"</li>
                    </ul>
                    
                    <h5>Alur Kerja:</h5>
                    <ol>
                        <li>Klien terhubung ke server</li>
                        <li>Satu klien menjadi Master (manual atau auto)</li>
                        <li>Klien lain mengirim teks</li>
                        <li>Server konversi teks ke audio</li>
                        <li>Audio dikirim ke Master</li>
                        <li>Master memutar audio</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div x-show="showHelpModal" class="modal-overlay" @click.self="showHelpModal = false">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-question-circle"></i> Panduan Penggunaan</h3>
                <button @click="showHelpModal = false" class="btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="help-content">
                    <h4>Cara Menggunakan:</h4>
                    
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h5>Persiapan</h5>
                            <p>Pastikan semua komputer terhubung ke jaringan yang sama. Buka alamat server di semua browser.</p>
                        </div>
                    </div>
                    
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h5>Menentukan Master</h5>
                            <p>Di komputer yang memiliki speaker (output audio), klik "Jadikan Master". Komputer ini akan memutar semua audio.</p>
                            <p><strong>Tips:</strong> Aktifkan "Ingin selalu menjadi Master" di Pengaturan Master untuk auto-reconnect.</p>
                        </div>
                    </div>
                    
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h5>Mengirim Teks</h5>
                            <p>Di komputer lain (client biasa), masukkan teks, pilih bahasa, dan klik "Kirim ke Master". Audio akan diputar di komputer Master.</p>
                        </div>
                    </div>
                    
                    <div class="step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h5>Broadcast (Opsional)</h5>
                            <p>Master dapat mengirim audio ke semua komputer dengan klik "Kirim ke Semua".</p>
                        </div>
                    </div>
                    
                    <h5>Troubleshooting:</h5>
                    <ul>
                        <li><strong>Audio tidak keluar:</strong> Pastikan komputer Master memiliki speaker aktif dan volume cukup.</li>
                        <li><strong>Tidak bisa jadi Master:</strong> Hanya satu Master yang aktif. Tunggu atau minta Master saat ini melepaskan peran.</li>
                        <li><strong>Koneksi terputus:</strong> Sistem akan otomatis reconnect. Master akan coba kembali sebagai Master.</li>
                        <li><strong>Teks tidak terkirim:</strong> Pastikan ada Master yang aktif dan teks tidak kosong.</li>
                        <li><strong>Auto-reconnect tidak bekerja:</strong> Cek "Pengaturan Master" dan pastikan preferensi sudah disimpan.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Element (Hidden) -->
    <audio id="hiddenAudio" style="display: none;"></audio>
</body>
</html>